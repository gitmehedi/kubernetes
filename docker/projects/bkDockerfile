FROM ubuntu:16.04
MAINTAINER gitmehedi

# make the "en_US.UTF-8" locale so postgres will be utf-8 enabled by default
#RUN locale-gen en_US.UTF-8
#RUN update-locale LANG=en_US.UTF-8

#Install and setup postgresql
RUN set -x; \
        apt-get update \
        && apt-get install -y postgresql
USER postgres
RUN /etc/init.d/postgresql start  && psql --command "CREATE USER root WITH SUPERUSER CREATEDB REPLICATION;"
USER root
ENV PGDATA /var/lib/postgresql/data


RUN set -x; \
        apt-get update \
        && apt-get install -y --no-install-recommends \
            git \
	    sudo \
            ca-certificates \
            curl \
            node-less \
            npm \
            python-gevent \
            python-pip \
            python-pyinotify \
            python-renderpm \
            unzip \
            python-setuptools
RUN set -x; mkdir -p /opt/odoo && cd /opt/odoo && mkdir server custom osapps

#Install Odoo
COPY ./odoo.zip /opt/odoo/server/
RUN set -x; unzip /opt/odoo/server/odoo.zip -d /opt/odoo/server/

# Copy dependencies of Odoo

COPY ./pip_packages ./pip_packages
RUN set -x; pip install --no-index --find-links pip_packages -r /opt/odoo/server/10.0/requirements.txt
